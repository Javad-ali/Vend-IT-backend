# =============================================================================
# Vend-IT Backend Environment Configuration
# =============================================================================
# Copy this file to .env and fill in the values for your environment.
# Never commit the actual .env file to version control.
# =============================================================================

# -----------------------------------------------------------------------------
# Application
# -----------------------------------------------------------------------------
NODE_ENV=development
PORT=3000
HOST=0.0.0.0

# Comma-separated list of allowed CORS origins (leave empty for development)
# Example: https://app.vendit.com,https://admin.vendit.com
# For local development with Next.js admin: http://localhost:3000,http://localhost:3001
ALLOWED_ORIGINS=

# -----------------------------------------------------------------------------
# Supabase (PostgreSQL Database)
# -----------------------------------------------------------------------------
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key
SUPABASE_ANON_KEY=your-anon-key

# -----------------------------------------------------------------------------
# Redis (Cache & Queue)
# -----------------------------------------------------------------------------
# Use redis://localhost:6379 for local development
# Use memory://local for in-memory fallback (development only)
REDIS_URL=redis://localhost:6379

# -----------------------------------------------------------------------------
# JWT Authentication
# -----------------------------------------------------------------------------
# Generate strong secrets: openssl rand -base64 64
JWT_ACCESS_SECRET=your-access-token-secret-min-32-chars
JWT_REFRESH_SECRET=your-refresh-token-secret-min-32-chars
ACCESS_TOKEN_TTL=15m
REFRESH_TOKEN_TTL=30d

# -----------------------------------------------------------------------------
# Session & Cookies
# -----------------------------------------------------------------------------
# Generate a strong secret: openssl rand -base64 32
COOKIE_SECRET=your-session-cookie-secret

# -----------------------------------------------------------------------------
# Firebase (Push Notifications)
# -----------------------------------------------------------------------------
# Option 1: Provide individual values
FIREBASE_PROJECT_ID=your-firebase-project-id
FIREBASE_CLIENT_EMAIL=firebase-adminsdk@your-project.iam.gserviceaccount.com
FIREBASE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n"

# Option 2: Provide the entire service account JSON
# FIREBASE_SERVICE_ACCOUNT={"type":"service_account","project_id":"..."}

# Option 3: Reference a JSON file path
# FIREBASE_SERVICE_ACCOUNT=@/path/to/service-account.json

# -----------------------------------------------------------------------------
# Tap Payments
# -----------------------------------------------------------------------------
TAP_API_BASE_URL=https://api.tap.company/v2
TAP_SECRET_KEY=sk_test_REPLACE_WITH_YOUR_KEY
TAP_PUBLIC_KEY=pk_test_REPLACE_WITH_YOUR_KEY
TAP_DEFAULT_CURRENCY=KWD
TAP_COUNTRY_CODE=965

# Webhook signature verification (recommended for production)
TAP_WEBHOOK_SECRET=

# -----------------------------------------------------------------------------
# Silkron (Vending Machine Integration)
# -----------------------------------------------------------------------------
SILKRON_WEBHOOK_SECRET=

# -----------------------------------------------------------------------------
# Remote Machine API (Data Sync)
# -----------------------------------------------------------------------------
REMOTE_MACHINE_BASE_URL=https://your-machine-api.com/rest
REMOTE_MACHINE_API_KEY=your-api-key
REMOTE_MACHINE_PAGE_SIZE=100

# -----------------------------------------------------------------------------
# Dispense WebSocket
# -----------------------------------------------------------------------------
DISPENSE_SOCKET_URL=wss://central-6vfl.onrender.com

# -----------------------------------------------------------------------------
# SMS Provider (OTP Delivery)
# -----------------------------------------------------------------------------
# Driver: 'log' (development - logs OTP to console) or 'remote' (production - uses API)
# Provider: SMSBox (Kuwait)
SMS_DRIVER=log
SMS_API_URL=http://smsbox.com/smsgateway/services/messaging.asmx/Http_SendSMS
SMS_USERNAME=vendit
SMS_PASSWORD=
SMS_CUSTOMER_ID=3461
SMS_SENDER=VEND IT

# Fallback to logging OTP if SMS fails (development only)
ALLOW_SMS_FALLBACK=true

# -----------------------------------------------------------------------------
# Loyalty Program
# -----------------------------------------------------------------------------
# Points earned per 1 KWD spent
LOYALTY_BASE_RATE=10

# Multiplier for healthy products (health_rating >= 3)
LOYALTY_HEALTHY_MULTIPLIER=1.5

# Multiplier for low health products (health_rating = 1)
LOYALTY_LOW_HEALTH_MULTIPLIER=1

# KWD value per loyalty point
LOYALTY_POINT_VALUE=0.001

# -----------------------------------------------------------------------------
# Referral Program
# -----------------------------------------------------------------------------
# Points awarded to inviter when referral completes
REFERRAL_INVITER_POINTS=250

# Points awarded to invitee when they sign up with referral
REFERRAL_INVITEE_POINTS=250

# Base URL for referral share links
REFERRAL_SHARE_BASE_URL=https://vendit.app/r/

# Message template for referral sharing
REFERRAL_SHARE_MESSAGE=Join Vend-IT and get {points} bonus points! Use my code: {code}

# -----------------------------------------------------------------------------
# Email
# -----------------------------------------------------------------------------
EMAIL_FROM=no-reply@vendit.com

# -----------------------------------------------------------------------------
# AI Image Generation (Optional)
# -----------------------------------------------------------------------------
VYRO_API_URL=https://api.vyro.ai/v1/imagine/api/generations
VYRO_API_KEY=

# -----------------------------------------------------------------------------
# CDN (User Avatars & Assets)
# -----------------------------------------------------------------------------
CDN_BASE_URL=https://cdn.vendit.com

# -----------------------------------------------------------------------------
# Ngrok (Development Tunneling)
# -----------------------------------------------------------------------------
NGROK_AUTHTOKEN=
